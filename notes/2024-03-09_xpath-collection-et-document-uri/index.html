<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../sunset.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../../_app/immutable/assets/0.D0TAEvq0.css" rel="stylesheet">
		<link rel="modulepreload" href="../../_app/immutable/entry/start.B9fD-3Wj.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/ATQqNzrN.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CXCHmQ-B.js">
		<link rel="modulepreload" href="../../_app/immutable/entry/app.DF3f1qoj.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/C1FmrZbK.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DuaWf0Pd.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/0.HaHf7Tap.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DKuRuggZ.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/4.BFtRo3cN.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BheWnx7M.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/D2-NGLRx.js"><!-- HEAD_svelte-1i32evn_START --><!-- HEAD_svelte-1i32evn_END -->
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">     <div class="content">  <nav class="svelte-epptjw"> <a href="/" class="svelte-epptjw" data-svelte-h="svelte-4ebbsj"><h1 class="svelte-epptjw">/log</h1></a> <ul class="svelte-epptjw"><li><a href="/reports" class="svelte-epptjw" data-svelte-h="svelte-12wekpw">Comptes rendus</a></li> <li><a href="/notes" class="svelte-epptjw active" data-svelte-h="svelte-eu7epz">Notes</a></li> <li><a href="/projets" class="svelte-epptjw" data-svelte-h="svelte-4lv15p">Projets</a></li>  <li><button class="switch svelte-epptjw" role="switch" aria-checked="true"></button></li></ul></nav>   <main>  <article><p class="date">9 mars 2022</p> <h1 data-svelte-h="svelte-1x6i7fd">Les fonctions XPath collection() et document-uri()</h1> <h2 data-svelte-h="svelte-19dgfu"><code>collection()</code></h2> <p data-svelte-h="svelte-i502s2">Renvoie une séquence d’éléments identifiés par une URI, ou une collection par défaut si aucune URI n’est fournie.</p> <pre class="language-xml"><!-- HTML_TAG_START --><code class="language-xml">collection('.?select=*.xml') <span class="token comment">&lt;!-- retourne une collection de document xml --></span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1d7cbwu">Pour récupérer le nom de chaque fichier, deux fonctions peuvent être utilisées : <code>document-uri()</code> et <code>base-uri()</code>.
voir <a href="https://stackoverflow.com/questions/77325893/document-uri-is-not-working-when-using-collection" rel="nofollow">document-uri() is not working when using collection()</a>.</p> <h3 data-svelte-h="svelte-17bddup"><a href="https://www.saxonica.com/documentation12/index.html#!functions/fn/document-uri" rel="nofollow"><code>document-uri()</code></a></h3> <blockquote data-svelte-h="svelte-mdxtwr"><p>Les documents lus à l’aide de la fonction <code>collection()</code> sont ajoutés au pool de documents (et ont donc une propriété <code>document-uri()</code>) si et seulement si la collection est stable. Dans Saxon, pour des raisons de performance, les collections ne sont pas stables à moins que l’option de configuration <code>STABLE_COLLECTION_URI</code> ne soit activée ou que la stabilité ne soit demandée d’une autre manière, par exemple en incluant le paramètre <code>stable=yes</code> dans l’URI de la collection.</p></blockquote> <pre class="language-xml"><!-- HTML_TAG_START --><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>for-each</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>collection('.?select=*.xml<span class="token entity named-entity" title="&amp;">&amp;amp;</span>content-type=application/xml<span class="token entity named-entity" title="&amp;">&amp;amp;</span>stable=yes')<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>filename<span class="token punctuation">"</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tokenize(base-uri(.), '/')[last()]<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>substring-before($filename, '.xml')<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>result-document</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>output/&#123;$id&#125;.txt<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>apply-templates</span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>result-document</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>for-each</span><span class="token punctuation">></span></span></code><!-- HTML_TAG_END --></pre> <h3 data-svelte-h="svelte-matp2t"><a href="https://www.saxonica.com/documentation12/index.html#!functions/fn/base-uri" rel="nofollow"><code>base-uri()</code></a></h3> <p data-svelte-h="svelte-h5q82w">Il n’est pas nécessaire d’avoir une collection stable avec <code>base-uri()</code>.</p> <pre class="language-xml"><!-- HTML_TAG_START --><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>for-each</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>collection('.?select=*.xml')<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>filename<span class="token punctuation">"</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tokenize(base-uri(.), '/')[last()]<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>substring-before($filename, '.xml')<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>result-document</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>output/&#123;$id&#125;.txt<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>apply-templates</span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>result-document</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>for-each</span><span class="token punctuation">></span></span>
</code><!-- HTML_TAG_END --></pre></article></main>   <footer class="svelte-1capoi1" data-svelte-h="svelte-1h3xx8c"><nav><ul class="svelte-1capoi1"><li><a href="https://github.com/sardinecan/log" class="svelte-1capoi1">Github</a></li> </ul></nav></footer> </div> 
			
			<script>
				{
					__sveltekit_fy0s1o = {
						base: new URL("../..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../../_app/immutable/entry/start.B9fD-3Wj.js"),
						import("../../_app/immutable/entry/app.DF3f1qoj.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 4],
							data: [null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
